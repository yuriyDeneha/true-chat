!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common/http"),require("@angular/platform-browser"),require("rxjs"),require("rxjs/operators"),require("@angular/common"),require("@nguniversal/express-engine/tokens")):"function"==typeof define&&define.amd?define("@gorniv/ngx-universal",["exports","@angular/core","@angular/common/http","@angular/platform-browser","rxjs","rxjs/operators","@angular/common","@nguniversal/express-engine/tokens"],e):e(((t=t||self).gorniv=t.gorniv||{},t.gorniv["ngx-universal"]={}),t.ng.core,t.ng.common.http,t.ng.platformBrowser,t.rxjs,t.rxjs.operators,t.ng.common,t.tokens)}(this,function(t,e,r,o,n,i,s,u){"use strict";var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};var c=function(){function t(t,e,r){this.transferState=t,this.httpClient=e,this.platformId=r}return t.prototype.request=function(t,e,r){var o=this;return this.getData(t,e,r,function(t,e,r){return o.httpClient.request(t,e,r)})},t.prototype.get=function(t,e){var r=this;return this.getData("get",t,e,function(t,e,o){return r.httpClient.get(e,o)})},t.prototype.post=function(t,e,r){var o=this;return this.getPostData("post",t,e,r,function(t,e,r,n){return o.httpClient.post(e,r,n)})},t.prototype.put=function(t,e,r){var o=this;return this.getPostData("put",t,e,r,function(t,e,r,n){return o.httpClient.put(e,r,n)})},t.prototype["delete"]=function(t,e){var r=this;return this.getData("delete",t,e,function(t,e,o){return r.httpClient["delete"](e,o)})},t.prototype.patch=function(t,e,r){var o=this;return this.getPostData("patch",t,e,r,function(t,e,r,n){return o.httpClient.patch(e,r,n)})},t.prototype.head=function(t,e){var r=this;return this.getData("head",t,e,function(t,e,o){return r.httpClient.head(e,o)})},t.prototype.options=function(t,e){var r=this;return this.getData("options",t,e,function(t,e,o){return r.httpClient.options(e,o)})},t.prototype.getData=function(t,e,r,n){var u=this,a=e;"string"!=typeof e&&(a=e.url);var c=a+(r?JSON.stringify(r):""),p=o.makeStateKey(c);try{return this.resolveData(p)}catch(f){return n(t,e,r).pipe(i.tap(function(t){s.isPlatformBrowser(u.platformId),s.isPlatformServer(u.platformId)&&u.setCache(p,t)}))}},t.prototype.getPostData=function(t,e,r,n,u){var a=this,c=e;"string"!=typeof e&&(c=e.url);var p=c+(r?JSON.stringify(r):"")+(n?JSON.stringify(n):""),f=o.makeStateKey(p);try{return this.resolveData(f)}catch(d){return u(t,e,r,n).pipe(i.tap(function(t){s.isPlatformBrowser(a.platformId),s.isPlatformServer(a.platformId)&&a.setCache(f,t)}))}},t.prototype.resolveData=function(t){var e=this.getFromCache(t);if(!e)throw new Error;return s.isPlatformBrowser(this.platformId)&&this.transferState.remove(t),s.isPlatformServer(this.platformId),n.from(Promise.resolve(e))},t.prototype.setCache=function(t,e){return this.transferState.set(t,e)},t.prototype.getFromCache=function(t){return this.transferState.get(t,null)},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:o.TransferState},{type:r.HttpClient},{type:Object,decorators:[{type:e.Inject,args:[e.PLATFORM_ID]}]}]},t}(),p=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{providers:[c]}]}],t}();function f(t){return t===undefined||null===t}function d(t){return t!==undefined&&null!==t}function l(t){return"string"==typeof t}function h(t,e){return e?{path:d(e.path)?e.path:t.path,domain:d(e.domain)?e.domain:t.domain,expires:d(e.expires)?e.expires:t.expires,secure:d(e.secure)?e.secure:t.secure,httpOnly:d(e.httpOnly)?e.httpOnly:t.httpOnly,storeUnencoded:d(e.storeUnencoded)?e.storeUnencoded:t.storeUnencoded}:t}function y(t){try{return decodeURIComponent(t)}catch(e){return t}}function g(t){try{return JSON.parse(t)}catch(e){return t}}var v=new e.InjectionToken("COOKIE_OPTIONS"),m=function(){function t(t,e){void 0===t&&(t={}),this._injector=e,this.defaultOptions={path:this._injector.get(s.APP_BASE_HREF,"/"),domain:null,expires:null,secure:!1,httpOnly:!1},this._options=h(this.defaultOptions,t)}return Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:undefined,decorators:[{type:e.Inject,args:[v]}]},{type:e.Injector}]},t}(),k=function(){function t(t){this._optionsProvider=t,this.options=this._optionsProvider.options}return Object.defineProperty(t.prototype,"cookieString",{get:function(){return document.cookie||""},set:function(t){document.cookie=t},enumerable:!0,configurable:!0}),t.prototype.get=function(t){return this._cookieReader()[t]},t.prototype.getObject=function(t){var e=this.get(t);return e?g(e):e},t.prototype.getAll=function(){return this._cookieReader()},t.prototype.put=function(t,e,r){this._cookieWriter()(t,e,r)},t.prototype.putObject=function(t,e,r){this.put(t,JSON.stringify(e),r)},t.prototype.remove=function(t,e){this._cookieWriter()(t,undefined,e)},t.prototype.removeAll=function(t){var e=this,r=this.getAll();Object.keys(r).forEach(function(r){e.remove(r,t)})},t.prototype._cookieReader=function(){var t,e,r,o,n,i={},s="",u=this.cookieString;if(u!==s)for(t=(s=u).split("; "),i={},r=0;r<t.length;r++)(o=(e=t[r]).indexOf("="))>0&&f(i[n=y(e.substring(0,o))])&&(i[n]=y(e.substring(o+1)));return i},t.prototype._cookieWriter=function(){var t=this;return function(e,r,o){t.cookieString=t._buildCookieString(e,r,o)}},t.prototype._buildCookieString=function(t,e,r){var o=h(this.options,r),n=o.expires;f(e)&&(n="Thu, 01 Jan 1970 00:00:00 GMT",e=""),l(n)&&(n=new Date(n));var i=o.storeUnencoded?e:encodeURIComponent(e),s=encodeURIComponent(t)+"="+i;s+=o.path?";path="+o.path:"",s+=o.domain?";domain="+o.domain:"",s+=n?";expires="+n.toUTCString():"",s+=o.secure?";secure":"";var u=(s+=o.httpOnly?"; HttpOnly":"").length+1;return u>4096&&console.log("Cookie '"+t+"' possibly not set or overflowed because it was too large ("+u+" > 4096 bytes)!"),s},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:m}]},t}(),O=function(t){function r(e,r,o){var n=t.call(this,o)||this;return n.request=e,n.response=r,n}return function(t,e){function r(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(r,t),Object.defineProperty(r.prototype,"cookieString",{get:function(){return this.request.cookie||this.request.headers.cookie||""},set:function(t){this.request.cookie=t,this.response.cookie=t},enumerable:!0,configurable:!0}),r.prototype.put=function(t,e,r){var o=this;void 0===r&&(r={});var n=!1,i=Object.keys(this.getAll()).map(function(r){return r===t?(n=!0,t+"="+e):r+"="+o.get(r)}).join("; ");n||(i+="; "+t+"="+e+";"),this.request.headers.cookie=i,this.cookieString=i},r.prototype.remove=function(t,e){var r=this,o=Object.keys(this.getAll()).map(function(e){return e===t?"":e+"="+r.get(e)}).join("; ");this.request.headers.cookie=o,this.cookieString=o},r.decorators=[{type:e.Injectable}],r.ctorParameters=function(){return[{type:undefined,decorators:[{type:e.Inject,args:[u.REQUEST]}]},{type:undefined,decorators:[{type:e.Inject,args:[u.RESPONSE]}]},{type:m}]},r}(k);function S(t){return new k(t)}var j=function(){function t(){}return t.forRoot=function(e){return void 0===e&&(e={}),{ngModule:t,providers:[{provide:v,useValue:e},{provide:k,useFactory:S,deps:[m]}]}},t.forChild=function(e){return void 0===e&&(e={}),{ngModule:t,providers:[{provide:v,useValue:e},{provide:k,useFactory:S,deps:[m]}]}},t.decorators=[{type:e.NgModule,args:[{providers:[m]}]}],t}(),b=function(){function t(t,e){this.rendererFactory=t,this.document=e}return t.prototype.addTag=function(t,r){try{var o=this.rendererFactory.createRenderer(this.document,{id:"-1",encapsulation:e.ViewEncapsulation.None,styles:[],data:{}}),n=o.createElement("link"),i=this.document.head;this._parseSelector(t);if(null===i)throw new Error("<head> not found within DOCUMENT.");Object.keys(t).forEach(function(e){return o.setAttribute(n,e,t[e])}),o.appendChild(i,n)}catch(s){console.error("Error within linkService : ",s)}},t.prototype._parseSelector=function(t){var e=t.rel?"rel":"hreflang";return e+'="'+t[e]+'"'},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]},{type:e.Injectable}],t.ctorParameters=function(){return[{type:e.RendererFactory2},{type:undefined,decorators:[{type:e.Inject,args:[o.DOCUMENT]}]}]},t}(),C=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[s.CommonModule],providers:[b]}]}],t}();t.COOKIE_OPTIONS=v,t.CookieBackendService=O,t.CookieModule=j,t.CookieOptionsProvider=m,t.CookieService=k,t.LinkModule=C,t.LinkService=b,t.TransferHttpModule=p,t.TransferHttpService=c,t.cookieServiceFactory=S,t.isBlank=f,t.isPresent=d,t.isString=l,t.mergeOptions=h,t.safeDecodeURIComponent=y,t.safeJsonParse=g,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=gorniv-ngx-universal.umd.min.js.map